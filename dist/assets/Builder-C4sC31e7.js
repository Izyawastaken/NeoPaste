import{u as b,r as t,j as e}from"./index-iNipDE1h.js";import{p as I,c as C,A as v}from"./AccentPicker-Bw-Fckpn.js";async function S(a){const n=new TextEncoder().encode(a),o=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(o)).map(i=>i.toString(16).padStart(2,"0")).join("")}const P="https://pywievpwcedaareqkuxm.supabase.co",N="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5d2lldnB3Y2VkYWFyZXFrdXhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzMTA5MjMsImV4cCI6MjA2Nzg4NjkyM30.wHvcWCjkejn811z_ELF-9zvoR8_UjIYJd2e57A8QBIs",A=C(P,N);function R(){b();const[a,r]=t.useState(""),[n,o]=t.useState(""),[i,c]=t.useState(""),[p,f]=t.useState(!1),[m,x]=t.useState(null),k=t.useRef(null),u=t.useMemo(()=>i.replace(/[“”]/g,'"').replace(/\u200B/g,"").replace(/\r/g,"").trim(),[i]),g=t.useCallback(async s=>{var l;const d=((l=s.clipboardData)==null?void 0:l.getData("text"))||"";if(d.includes("pokepast.es")){s.preventDefault();const h=await L(d);h?c(h.trim()):alert("⚠️ Failed to import from Pokepaste. Check the link!")}},[]),j=t.useCallback(async s=>{if(s.preventDefault(),!u){alert("Paste content can't be empty!");return}const d=await S(u);if(d===k.current){alert("⚠️ This team was already pasted. Please modify it first.");return}let l;try{if(l=I(u),!l||l.length===0)throw new Error("Empty")}catch{alert("⚠️ Invalid team format! Please check your paste.");return}f(!0);const h=Math.random().toString(36).substring(2,8),{error:y}=await A.from("pastes").insert([{id:h,title:a.trim(),author:n.trim(),content:u,created_at:new Date().toISOString()}]);if(f(!1),y){console.error(y),alert("❌ Failed to save paste to Supabase!");return}k.current=d;const w=`/view/${h}`;x(w)},[n,u,a]);return e.jsxs("div",{className:"container",children:[e.jsxs("header",{children:[e.jsx("h1",{children:"NeoPaste"}),e.jsx("p",{className:"subtitle",children:"Share your Pokémon teams with style."})]}),e.jsxs("form",{onSubmit:j,id:"pasteForm",children:[e.jsx("input",{type:"text",placeholder:"Paste Title",value:a,onChange:s=>r(s.target.value)}),e.jsx("input",{type:"text",placeholder:"Author (optional)",value:n,onChange:s=>o(s.target.value)}),e.jsx("textarea",{id:"content",placeholder:"Paste your team here...",rows:20,spellCheck:!1,value:i,onChange:s=>c(s.target.value),onPaste:g}),e.jsx("button",{type:"submit",disabled:p,children:p?"Saving…":"Generate Link"})]}),e.jsx("div",{id:"paste-link",children:m&&e.jsxs("div",{className:"paste-output fade-in",children:[e.jsx("p",{children:e.jsx("strong",{children:"Your Paste Link:"})}),e.jsxs("div",{className:"link-buttons",children:[e.jsx("a",{className:"fancy-btn",href:m,target:"_blank",rel:"noreferrer",children:"🔗 View Paste"}),e.jsx(E,{link:m}),e.jsx("span",{className:"link-status",style:{marginLeft:10,color:"green"},children:"✅ Link updated!"})]})]})}),e.jsx("footer",{children:e.jsxs("p",{children:["Inspired by ",e.jsx("a",{href:"https://pokepast.es",target:"_blank",rel:"noreferrer",children:"Pokepaste"})," by felixphew"]})}),e.jsx(v,{}),e.jsx("a",{className:"floating-report-btn",href:"https://github.com/Izyawastaken/NeoPaste/issues",target:"_blank",rel:"noreferrer",children:"🐛 Report Issues Here"})]})}function E({link:a}){const[r,n]=t.useState(!1),o=t.useCallback(async()=>{await navigator.clipboard.writeText(a),n(!0),setTimeout(()=>n(!1),1500)},[a]);return e.jsx("button",{className:`copy-link-btn fancy-btn ${r?"copied":""}`,onClick:o,disabled:r,children:r?"✅ Copied!":"📋 Copy Link"})}async function L(a){const r=a.match(/pokepast\.es\/([a-z0-9]+)/i);if(!r)return null;const o=`https://pokepast.es/${r[1]}`,i=`https://neopasteworker.agastyawastaken.workers.dev/?url=${encodeURIComponent(o)}`;try{const c=await fetch(i);if(!c.ok)throw new Error("Bad response");const p=await c.text();if(p.toLowerCase().includes("<html"))throw new Error("Received HTML instead of paste content");return p.trim()}catch(c){return console.error("Pokepaste import failed:",c),null}}export{R as default};

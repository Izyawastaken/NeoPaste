import{j as e}from"./index-Dti5_RhW.js";import{r as t}from"./vendor-BNM8eXaP.js";import{c as b}from"./supabase-C-8FjU3g.js";import{p as I,A as C}from"./AccentPicker-D8fftsQz.js";import{u as S}from"./router-DAhkMhWZ.js";async function v(a){const n=new TextEncoder().encode(a),o=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(o)).map(i=>i.toString(16).padStart(2,"0")).join("")}const P="https://pywievpwcedaareqkuxm.supabase.co",A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5d2lldnB3Y2VkYWFyZXFrdXhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzMTA5MjMsImV4cCI6MjA2Nzg4NjkyM30.wHvcWCjkejn811z_ELF-9zvoR8_UjIYJd2e57A8QBIs",N=b(P,A);function M(){S();const[a,r]=t.useState(""),[n,o]=t.useState(""),[i,c]=t.useState(""),[p,m]=t.useState(!1),[h,x]=t.useState(null),f=t.useRef(null),u=t.useMemo(()=>i.replace(/[â€œâ€]/g,'"').replace(/\u200B/g,"").replace(/\r/g,"").trim(),[i]),g=t.useCallback(async s=>{const d=s.clipboardData?.getData("text")||"";if(d.includes("pokepast.es")){s.preventDefault();const l=await L(d);l?c(l.trim()):alert("âš ï¸ Failed to import from Pokepaste. Check the link!")}},[]),j=t.useCallback(async s=>{if(s.preventDefault(),!u){alert("Paste content can't be empty!");return}const d=await v(u);if(d===f.current){alert("âš ï¸ This team was already pasted. Please modify it first.");return}let l;try{if(l=I(u),!l||l.length===0)throw new Error("Empty")}catch{alert("âš ï¸ Invalid team format! Please check your paste.");return}m(!0);const k=Math.random().toString(36).substring(2,8),{error:y}=await N.from("pastes").insert([{id:k,title:a.trim(),author:n.trim(),content:u,created_at:new Date().toISOString()}]);if(m(!1),y){console.error(y),alert("âŒ Failed to save paste to Supabase!");return}f.current=d;const w=`/view/${k}`;x(w)},[n,u,a]);return e.jsxs("div",{className:"container",children:[e.jsxs("header",{children:[e.jsx("h1",{children:"Sanctum"}),e.jsx("p",{className:"subtitle",children:"Share your PokÃ©mon teams with style."})]}),e.jsxs("form",{onSubmit:j,id:"pasteForm",children:[e.jsx("input",{type:"text",id:"title",placeholder:"Paste Title",value:a,onChange:s=>r(s.target.value)}),e.jsx("input",{type:"text",id:"author",placeholder:"Author (optional)",value:n,onChange:s=>o(s.target.value)}),e.jsx("textarea",{id:"content",placeholder:"Paste your team here...",rows:20,spellCheck:!1,value:i,onChange:s=>c(s.target.value),onPaste:g}),e.jsx("button",{type:"submit",disabled:p,children:p?"Savingâ€¦":"Generate Link"})]}),e.jsx("div",{id:"paste-link",children:h&&e.jsxs("div",{className:"paste-output fade-in",children:[e.jsx("p",{children:e.jsx("strong",{children:"Your Paste Link:"})}),e.jsxs("div",{className:"link-buttons",children:[e.jsx("a",{className:"fancy-btn",href:h,target:"_blank",rel:"noreferrer",children:"ðŸ”— View Paste"}),e.jsx(E,{link:h}),e.jsx("span",{className:"link-status",style:{marginLeft:10,color:"green"},children:"âœ… Link updated!"})]})]})}),e.jsx("footer",{children:e.jsxs("p",{children:["Inspired by ",e.jsx("a",{href:"https://pokepast.es",target:"_blank",rel:"noreferrer",children:"Pokepaste"})," by felixphew"]})}),e.jsx(C,{}),e.jsx("a",{className:"floating-report-btn",href:"https://github.com/Izyawastaken/NeoPaste/issues",target:"_blank",rel:"noreferrer",children:"ðŸ› Report Issues Here"})]})}function E({link:a}){const[r,n]=t.useState(!1),o=t.useCallback(async()=>{await navigator.clipboard.writeText(a),n(!0),setTimeout(()=>n(!1),1500)},[a]);return e.jsx("button",{className:`copy-link-btn fancy-btn ${r?"copied":""}`,onClick:o,disabled:r,children:r?"âœ… Copied!":"ðŸ“‹ Copy Link"})}async function L(a){const r=a.match(/pokepast\.es\/([a-z0-9]+)/i);if(!r)return null;const o=`https://pokepast.es/${r[1]}`,i=`https://neopasteworker.agastyawastaken.workers.dev/?url=${encodeURIComponent(o)}`;try{const c=await fetch(i);if(!c.ok)throw new Error("Bad response");const p=await c.text();if(p.toLowerCase().includes("<html"))throw new Error("Received HTML instead of paste content");return p.trim()}catch(c){return console.error("Pokepaste import failed:",c),null}}export{M as default};
